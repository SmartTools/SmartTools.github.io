<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.1 at 2016-07-04 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160704" />
    <meta http-equiv="Content-Language" content="en" />
    <title>SmartActors Core &#x2013; How to use Scopes</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarEnabled">
          
                
                    
                

    <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
                <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
                
                                <ul class="nav">
                                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="../project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="../dependency-convergence.html"  title="Dependency Convergence">Dependency Convergence</a>
</li>
                                  <li>      <a href="../dependency-info.html"  title="Dependency Information">Dependency Information</a>
</li>
                                  <li>      <a href="../distribution-management.html"  title="Distribution Management">Distribution Management</a>
</li>
                                  <li>      <a href="../index.html"  title="About">About</a>
</li>
                                  <li>      <a href="../modules.html"  title="Project Modules">Project Modules</a>
</li>
                                  <li>      <a href="../plugin-management.html"  title="Plugin Management">Plugin Management</a>
</li>
                                  <li>      <a href="../plugins.html"  title="Plugins">Plugins</a>
</li>
                                  <li>      <a href="../source-repository.html"  title="Source Code Management">Source Code Management</a>
</li>
                                  <li>      <a href="../project-summary.html"  title="Summary">Summary</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="../project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="../xref/index.html"  title="Source Xref">Source Xref</a>
</li>
                                  <li>      <a href="../surefire-report.html"  title="Surefire Report">Surefire Report</a>
</li>
                                  <li>      <a href="../checkstyle-aggregate.html"  title="Checkstyle">Checkstyle</a>
</li>
                                  <li>      <a href="../apidocs/index.html"  title="JavaDocs">JavaDocs</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="../tutorials"  title="Tutorials">Tutorials</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Modules <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="../core.iobject/index.html"  title="core.iobject">core.iobject</a>
</li>
                  
                      <li>      <a href="../core.ioc/index.html"  title="core.ioc">core.ioc</a>
</li>
                  
                      <li>      <a href="../core.iscope/index.html"  title="core.iscope">core.iscope</a>
</li>
                  
                      <li>      <a href="../core.scope_provider/index.html"  title="core.scope_provider">core.scope_provider</a>
</li>
                  
                      <li>      <a href="../core.recursive_scope/index.html"  title="core.recursive_scope">core.recursive_scope</a>
</li>
                  
                      <li>      <a href="../core.ioc_container/index.html"  title="core.ioc_container">core.ioc_container</a>
</li>
                  
                      <li>      <a href="../core.scope_provider_container/index.html"  title="core.scope_provider_container">core.scope_provider_container</a>
</li>
                  
                      <li>      <a href="../core.istrategy_container/index.html"  title="core.istrategy_container">core.istrategy_container</a>
</li>
                  
                      <li>      <a href="../core.iresolve_dependency_strategy/index.html"  title="core.iresolve_dependency_strategy">core.iresolve_dependency_strategy</a>
</li>
                  
                      <li>      <a href="../core.scope_guard/index.html"  title="core.scope_guard">core.scope_guard</a>
</li>
                  
                      <li>      <a href="../core.strategy_container/index.html"  title="core.strategy_container">core.strategy_container</a>
</li>
                  
                      <li>      <a href="../core.create_new_instance_strategy/index.html"  title="core.create_new_instance_strategy">core.create_new_instance_strategy</a>
</li>
                  
                      <li>      <a href="../core.singleton_strategy/index.html"  title="core.singleton_strategy">core.singleton_strategy</a>
</li>
                  
                      <li>      <a href="../core.string_ioc_key/index.html"  title="core.string_ioc_key">core.string_ioc_key</a>
</li>
                  
                      <li>      <a href="../core.iserver/index.html"  title="core.iserver">core.iserver</a>
</li>
                  
                      <li>      <a href="../core.server_with_ioc/index.html"  title="core.server_with_ioc">core.server_with_ioc</a>
</li>
                  
                      <li>      <a href="../core.proof_of_assumption/index.html"  title="core.proof_of_assumption">core.proof_of_assumption</a>
</li>
                  
                      <li>      <a href="../core.ikey/index.html"  title="core.ikey">core.ikey</a>
</li>
                  
                      <li>      <a href="../core.iioccontainer/index.html"  title="core.iioccontainer">core.iioccontainer</a>
</li>
                  
                      <li>      <a href="../core.ioc_container_simple/index.html"  title="core.ioc_container_simple">core.ioc_container_simple</a>
</li>
                  
                      <li>      <a href="../core.iscope_provider_container/index.html"  title="core.iscope_provider_container">core.iscope_provider_container</a>
</li>
                  
                      <li>      <a href="../core.resolve_by_name_ioc_strategy/index.html"  title="core.resolve_by_name_ioc_strategy">core.resolve_by_name_ioc_strategy</a>
</li>
                  
                      <li>      <a href="../core.resolve_by_name_ioc_with_lambda_strategy/index.html"  title="core.resolve_by_name_ioc_with_lambda_strategy">core.resolve_by_name_ioc_with_lambda_strategy</a>
</li>
                  
                      <li>      <a href="../core.iaction/index.html"  title="core.iaction">core.iaction</a>
</li>
                  
                      <li>      <a href="../core.scope_creation_event_handler/index.html"  title="core.scope_creation_event_handler">core.scope_creation_event_handler</a>
</li>
                  
                      <li>      <a href="../core.iobject_simple_implementation/index.html"  title="core.iobject_simple_implementation">core.iobject_simple_implementation</a>
</li>
                  
                      <li>      <a href="../core.itask/index.html"  title="core.itask">core.itask</a>
</li>
                  
                      <li>      <a href="../core.db_storage/index.html"  title="core.db_storage">core.db_storage</a>
</li>
                  
                      <li>      <a href="../core.sql_commons/index.html"  title="core.sql_commons">core.sql_commons</a>
</li>
                  
                      <li>      <a href="../core.idatabase_task/index.html"  title="core.idatabase_task">core.idatabase_task</a>
</li>
                  
                      <li>      <a href="../core.db_create_collection_task/index.html"  title="core.db_create_collection_task">core.db_create_collection_task</a>
</li>
                  
                      <li>      <a href="../core.db_upsert_task/index.html"  title="core.db_upsert_task">core.db_upsert_task</a>
</li>
                  
                      <li>      <a href="../core.get_by_id_task/index.html"  title="core.get_by_id_task">core.get_by_id_task</a>
</li>
                  
                      <li>      <a href="../core.db_delete_task/index.html"  title="core.db_delete_task">core.db_delete_task</a>
</li>
                  
                      <li>      <a href="../core.db_search_task/index.html"  title="core.db_search_task">core.db_search_task</a>
</li>
                  
                      <li>      <a href="../core.db_insert_task/index.html"  title="core.db_insert_task">core.db_insert_task</a>
</li>
                  
                      <li>      <a href="../core.examples/index.html"  title="core.examples">core.examples</a>
</li>
                  
                      <li>      <a href="../core.bootstrap_item/index.html"  title="core.bootstrap_item">core.bootstrap_item</a>
</li>
                  
                      <li>      <a href="../core.ibootstrap_item/index.html"  title="core.ibootstrap_item">core.ibootstrap_item</a>
</li>
                  
                      <li>      <a href="../core.invalid_argument_exception/index.html"  title="core.invalid_argument_exception">core.invalid_argument_exception</a>
</li>
                  
                      <li>      <a href="../core.ibootstrap/index.html"  title="core.ibootstrap">core.ibootstrap</a>
</li>
                  
                      <li>      <a href="../core.iplugin/index.html"  title="core.iplugin">core.iplugin</a>
</li>
                  
                      <li>      <a href="../plugin.subscribe_scope_provider_on_scope_creation/index.html"  title="plugin.subscribe_scope_provider_on_scope_creation">plugin.subscribe_scope_provider_on_scope_creation</a>
</li>
                  
                      <li>      <a href="../core.iplugin_loader/index.html"  title="core.iplugin_loader">core.iplugin_loader</a>
</li>
                  
                      <li>      <a href="../core.iplugin_loader_visitor/index.html"  title="core.iplugin_loader_visitor">core.iplugin_loader_visitor</a>
</li>
                  
                      <li>      <a href="../core.plugin_loader_visitor_empty_implementation/index.html"  title="core.plugin_loader_visitor_empty_implementation">core.plugin_loader_visitor_empty_implementation</a>
</li>
                  
                      <li>      <a href="../core.plugin_loader_from_jar/index.html"  title="core.plugin_loader_from_jar">core.plugin_loader_from_jar</a>
</li>
                  
                      <li>      <a href="../core.bootstrap/index.html"  title="core.bootstrap">core.bootstrap</a>
</li>
                  
                      <li>      <a href="../core.iplugin_creator/index.html"  title="core.iplugin_creator">core.iplugin_creator</a>
</li>
                  
                      <li>      <a href="../core.plugin_creator/index.html"  title="core.plugin_creator">core.plugin_creator</a>
</li>
                  
                      <li>      <a href="../core.server_with_plugin_loader/index.html"  title="core.server_with_plugin_loader">core.server_with_plugin_loader</a>
</li>
                  
                      <li>      <a href="../plugin.load_scope_provider/index.html"  title="plugin.load_scope_provider">plugin.load_scope_provider</a>
</li>
                  
                      <li>      <a href="../plugin.test_jar/index.html"  title="plugin.test_jar">plugin.test_jar</a>
</li>
                  
                      <li>      <a href="../core.named_keys_storage/index.html"  title="core.named_keys_storage">core.named_keys_storage</a>
</li>
                  
                      <li>      <a href="../core.filesystem_tracker/index.html"  title="core.filesystem_tracker">core.filesystem_tracker</a>
</li>
                  
                      <li>      <a href="../core.ifilesystem_tracker/index.html"  title="core.ifilesystem_tracker">core.ifilesystem_tracker</a>
</li>
                  
                      <li>      <a href="../core.ifeature_manager/index.html"  title="core.ifeature_manager">core.ifeature_manager</a>
</li>
                  
                      <li>      <a href="../core.feature_manager/index.html"  title="core.feature_manager">core.feature_manager</a>
</li>
                  
                      <li>      <a href="../core.ds_object/index.html"  title="core.ds_object">core.ds_object</a>
</li>
                  
                      <li>      <a href="../core.iwrapper_generator/index.html"  title="core.iwrapper_generator">core.iwrapper_generator</a>
</li>
                  
                      <li>      <a href="../core.wrapper_generator/index.html"  title="core.wrapper_generator">core.wrapper_generator</a>
</li>
                  
                      <li>      <a href="../core.server_with_iobject/index.html"  title="core.server_with_iobject">core.server_with_iobject</a>
</li>
                  
                      <li>      <a href="../core.iclass_generator/index.html"  title="core.iclass_generator">core.iclass_generator</a>
</li>
                  
                      <li>      <a href="../core.class_generator/index.html"  title="core.class_generator">core.class_generator</a>
</li>
                  
                      <li>      <a href="../core.imulti_action_strategy/index.html"  title="core.imulti_action_strategy">core.imulti_action_strategy</a>
</li>
                  
                      <li>      <a href="../core.ipool/index.html"  title="core.ipool">core.ipool</a>
</li>
                  
                      <li>      <a href="../core.pool/index.html"  title="core.pool">core.pool</a>
</li>
                  
                      <li>      <a href="../core.pool_guard/index.html"  title="core.pool_guard">core.pool_guard</a>
</li>
                  
                      <li>      <a href="../plugin.compile_query/index.html"  title="plugin.compile_query">plugin.compile_query</a>
</li>
                  
                      <li>      <a href="../core.postgres_connection/index.html"  title="core.postgres_connection">core.postgres_connection</a>
</li>
                  
                      <li>      <a href="../plugin.postgres_connection_pool/index.html"  title="plugin.postgres_connection_pool">plugin.postgres_connection_pool</a>
</li>
                  
                      <li>      <a href="../core.istorage_connection/index.html"  title="core.istorage_connection">core.istorage_connection</a>
</li>
                  
                      <li>      <a href="../core.recursive_strategy_container/index.html"  title="core.recursive_strategy_container">core.recursive_strategy_container</a>
</li>
                  
                      <li>      <a href="../core.cached_collection/index.html"  title="core.cached_collection">core.cached_collection</a>
</li>
                          </ul>
      </li>
                  </ul>
          
          
          
                               <ul class="nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Links <b class="caret"></b></a>
                <ul class="dropdown-menu">
                      <li>      <a href="https://github.com/SmartTools/smartactors-core"  title="GitHub repository">GitHub repository</a>
</li>
                  </ul>
              </li>
            </ul>
          
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>core</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 2016-07-04
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.2.0-SNAPSHOT
                      </li>
                      
              
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                
      <li>
  
                          <a href="../project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
                              <li class="nav-header">Documentation</li>
                              
      <li>
  
                          <a href="../tutorials" title="Tutorials">
          <span class="none"></span>
        Tutorials</a>
            </li>
                              <li class="nav-header">Modules</li>
                              
      <li>
  
                          <a href="../core.iobject/index.html" title="core.iobject">
          <span class="none"></span>
        core.iobject</a>
            </li>
                
      <li>
  
                          <a href="../core.ioc/index.html" title="core.ioc">
          <span class="none"></span>
        core.ioc</a>
            </li>
                
      <li>
  
                          <a href="../core.iscope/index.html" title="core.iscope">
          <span class="none"></span>
        core.iscope</a>
            </li>
                
      <li>
  
                          <a href="../core.scope_provider/index.html" title="core.scope_provider">
          <span class="none"></span>
        core.scope_provider</a>
            </li>
                
      <li>
  
                          <a href="../core.recursive_scope/index.html" title="core.recursive_scope">
          <span class="none"></span>
        core.recursive_scope</a>
            </li>
                
      <li>
  
                          <a href="../core.ioc_container/index.html" title="core.ioc_container">
          <span class="none"></span>
        core.ioc_container</a>
            </li>
                
      <li>
  
                          <a href="../core.scope_provider_container/index.html" title="core.scope_provider_container">
          <span class="none"></span>
        core.scope_provider_container</a>
            </li>
                
      <li>
  
                          <a href="../core.istrategy_container/index.html" title="core.istrategy_container">
          <span class="none"></span>
        core.istrategy_container</a>
            </li>
                
      <li>
  
                          <a href="../core.iresolve_dependency_strategy/index.html" title="core.iresolve_dependency_strategy">
          <span class="none"></span>
        core.iresolve_dependency_strategy</a>
            </li>
                
      <li>
  
                          <a href="../core.scope_guard/index.html" title="core.scope_guard">
          <span class="none"></span>
        core.scope_guard</a>
            </li>
                
      <li>
  
                          <a href="../core.strategy_container/index.html" title="core.strategy_container">
          <span class="none"></span>
        core.strategy_container</a>
            </li>
                
      <li>
  
                          <a href="../core.create_new_instance_strategy/index.html" title="core.create_new_instance_strategy">
          <span class="none"></span>
        core.create_new_instance_strategy</a>
            </li>
                
      <li>
  
                          <a href="../core.singleton_strategy/index.html" title="core.singleton_strategy">
          <span class="none"></span>
        core.singleton_strategy</a>
            </li>
                
      <li>
  
                          <a href="../core.string_ioc_key/index.html" title="core.string_ioc_key">
          <span class="none"></span>
        core.string_ioc_key</a>
            </li>
                
      <li>
  
                          <a href="../core.iserver/index.html" title="core.iserver">
          <span class="none"></span>
        core.iserver</a>
            </li>
                
      <li>
  
                          <a href="../core.server_with_ioc/index.html" title="core.server_with_ioc">
          <span class="none"></span>
        core.server_with_ioc</a>
            </li>
                
      <li>
  
                          <a href="../core.proof_of_assumption/index.html" title="core.proof_of_assumption">
          <span class="none"></span>
        core.proof_of_assumption</a>
            </li>
                
      <li>
  
                          <a href="../core.ikey/index.html" title="core.ikey">
          <span class="none"></span>
        core.ikey</a>
            </li>
                
      <li>
  
                          <a href="../core.iioccontainer/index.html" title="core.iioccontainer">
          <span class="none"></span>
        core.iioccontainer</a>
            </li>
                
      <li>
  
                          <a href="../core.ioc_container_simple/index.html" title="core.ioc_container_simple">
          <span class="none"></span>
        core.ioc_container_simple</a>
            </li>
                
      <li>
  
                          <a href="../core.iscope_provider_container/index.html" title="core.iscope_provider_container">
          <span class="none"></span>
        core.iscope_provider_container</a>
            </li>
                
      <li>
  
                          <a href="../core.resolve_by_name_ioc_strategy/index.html" title="core.resolve_by_name_ioc_strategy">
          <span class="none"></span>
        core.resolve_by_name_ioc_strategy</a>
            </li>
                
      <li>
  
                          <a href="../core.resolve_by_name_ioc_with_lambda_strategy/index.html" title="core.resolve_by_name_ioc_with_lambda_strategy">
          <span class="none"></span>
        core.resolve_by_name_ioc_with_lambda_strategy</a>
            </li>
                
      <li>
  
                          <a href="../core.iaction/index.html" title="core.iaction">
          <span class="none"></span>
        core.iaction</a>
            </li>
                
      <li>
  
                          <a href="../core.scope_creation_event_handler/index.html" title="core.scope_creation_event_handler">
          <span class="none"></span>
        core.scope_creation_event_handler</a>
            </li>
                
      <li>
  
                          <a href="../core.iobject_simple_implementation/index.html" title="core.iobject_simple_implementation">
          <span class="none"></span>
        core.iobject_simple_implementation</a>
            </li>
                
      <li>
  
                          <a href="../core.itask/index.html" title="core.itask">
          <span class="none"></span>
        core.itask</a>
            </li>
                
      <li>
  
                          <a href="../core.db_storage/index.html" title="core.db_storage">
          <span class="none"></span>
        core.db_storage</a>
            </li>
                
      <li>
  
                          <a href="../core.sql_commons/index.html" title="core.sql_commons">
          <span class="none"></span>
        core.sql_commons</a>
            </li>
                
      <li>
  
                          <a href="../core.idatabase_task/index.html" title="core.idatabase_task">
          <span class="none"></span>
        core.idatabase_task</a>
            </li>
                
      <li>
  
                          <a href="../core.db_create_collection_task/index.html" title="core.db_create_collection_task">
          <span class="none"></span>
        core.db_create_collection_task</a>
            </li>
                
      <li>
  
                          <a href="../core.db_upsert_task/index.html" title="core.db_upsert_task">
          <span class="none"></span>
        core.db_upsert_task</a>
            </li>
                
      <li>
  
                          <a href="../core.get_by_id_task/index.html" title="core.get_by_id_task">
          <span class="none"></span>
        core.get_by_id_task</a>
            </li>
                
      <li>
  
                          <a href="../core.db_delete_task/index.html" title="core.db_delete_task">
          <span class="none"></span>
        core.db_delete_task</a>
            </li>
                
      <li>
  
                          <a href="../core.db_search_task/index.html" title="core.db_search_task">
          <span class="none"></span>
        core.db_search_task</a>
            </li>
                
      <li>
  
                          <a href="../core.db_insert_task/index.html" title="core.db_insert_task">
          <span class="none"></span>
        core.db_insert_task</a>
            </li>
                
      <li>
  
                          <a href="../core.examples/index.html" title="core.examples">
          <span class="none"></span>
        core.examples</a>
            </li>
                
      <li>
  
                          <a href="../core.bootstrap_item/index.html" title="core.bootstrap_item">
          <span class="none"></span>
        core.bootstrap_item</a>
            </li>
                
      <li>
  
                          <a href="../core.ibootstrap_item/index.html" title="core.ibootstrap_item">
          <span class="none"></span>
        core.ibootstrap_item</a>
            </li>
                
      <li>
  
                          <a href="../core.invalid_argument_exception/index.html" title="core.invalid_argument_exception">
          <span class="none"></span>
        core.invalid_argument_exception</a>
            </li>
                
      <li>
  
                          <a href="../core.ibootstrap/index.html" title="core.ibootstrap">
          <span class="none"></span>
        core.ibootstrap</a>
            </li>
                
      <li>
  
                          <a href="../core.iplugin/index.html" title="core.iplugin">
          <span class="none"></span>
        core.iplugin</a>
            </li>
                
      <li>
  
                          <a href="../plugin.subscribe_scope_provider_on_scope_creation/index.html" title="plugin.subscribe_scope_provider_on_scope_creation">
          <span class="none"></span>
        plugin.subscribe_scope_provider_on_scope_creation</a>
            </li>
                
      <li>
  
                          <a href="../core.iplugin_loader/index.html" title="core.iplugin_loader">
          <span class="none"></span>
        core.iplugin_loader</a>
            </li>
                
      <li>
  
                          <a href="../core.iplugin_loader_visitor/index.html" title="core.iplugin_loader_visitor">
          <span class="none"></span>
        core.iplugin_loader_visitor</a>
            </li>
                
      <li>
  
                          <a href="../core.plugin_loader_visitor_empty_implementation/index.html" title="core.plugin_loader_visitor_empty_implementation">
          <span class="none"></span>
        core.plugin_loader_visitor_empty_implementation</a>
            </li>
                
      <li>
  
                          <a href="../core.plugin_loader_from_jar/index.html" title="core.plugin_loader_from_jar">
          <span class="none"></span>
        core.plugin_loader_from_jar</a>
            </li>
                
      <li>
  
                          <a href="../core.bootstrap/index.html" title="core.bootstrap">
          <span class="none"></span>
        core.bootstrap</a>
            </li>
                
      <li>
  
                          <a href="../core.iplugin_creator/index.html" title="core.iplugin_creator">
          <span class="none"></span>
        core.iplugin_creator</a>
            </li>
                
      <li>
  
                          <a href="../core.plugin_creator/index.html" title="core.plugin_creator">
          <span class="none"></span>
        core.plugin_creator</a>
            </li>
                
      <li>
  
                          <a href="../core.server_with_plugin_loader/index.html" title="core.server_with_plugin_loader">
          <span class="none"></span>
        core.server_with_plugin_loader</a>
            </li>
                
      <li>
  
                          <a href="../plugin.load_scope_provider/index.html" title="plugin.load_scope_provider">
          <span class="none"></span>
        plugin.load_scope_provider</a>
            </li>
                
      <li>
  
                          <a href="../plugin.test_jar/index.html" title="plugin.test_jar">
          <span class="none"></span>
        plugin.test_jar</a>
            </li>
                
      <li>
  
                          <a href="../core.named_keys_storage/index.html" title="core.named_keys_storage">
          <span class="none"></span>
        core.named_keys_storage</a>
            </li>
                
      <li>
  
                          <a href="../core.filesystem_tracker/index.html" title="core.filesystem_tracker">
          <span class="none"></span>
        core.filesystem_tracker</a>
            </li>
                
      <li>
  
                          <a href="../core.ifilesystem_tracker/index.html" title="core.ifilesystem_tracker">
          <span class="none"></span>
        core.ifilesystem_tracker</a>
            </li>
                
      <li>
  
                          <a href="../core.ifeature_manager/index.html" title="core.ifeature_manager">
          <span class="none"></span>
        core.ifeature_manager</a>
            </li>
                
      <li>
  
                          <a href="../core.feature_manager/index.html" title="core.feature_manager">
          <span class="none"></span>
        core.feature_manager</a>
            </li>
                
      <li>
  
                          <a href="../core.ds_object/index.html" title="core.ds_object">
          <span class="none"></span>
        core.ds_object</a>
            </li>
                
      <li>
  
                          <a href="../core.iwrapper_generator/index.html" title="core.iwrapper_generator">
          <span class="none"></span>
        core.iwrapper_generator</a>
            </li>
                
      <li>
  
                          <a href="../core.wrapper_generator/index.html" title="core.wrapper_generator">
          <span class="none"></span>
        core.wrapper_generator</a>
            </li>
                
      <li>
  
                          <a href="../core.server_with_iobject/index.html" title="core.server_with_iobject">
          <span class="none"></span>
        core.server_with_iobject</a>
            </li>
                
      <li>
  
                          <a href="../core.iclass_generator/index.html" title="core.iclass_generator">
          <span class="none"></span>
        core.iclass_generator</a>
            </li>
                
      <li>
  
                          <a href="../core.class_generator/index.html" title="core.class_generator">
          <span class="none"></span>
        core.class_generator</a>
            </li>
                
      <li>
  
                          <a href="../core.imulti_action_strategy/index.html" title="core.imulti_action_strategy">
          <span class="none"></span>
        core.imulti_action_strategy</a>
            </li>
                
      <li>
  
                          <a href="../core.ipool/index.html" title="core.ipool">
          <span class="none"></span>
        core.ipool</a>
            </li>
                
      <li>
  
                          <a href="../core.pool/index.html" title="core.pool">
          <span class="none"></span>
        core.pool</a>
            </li>
                
      <li>
  
                          <a href="../core.pool_guard/index.html" title="core.pool_guard">
          <span class="none"></span>
        core.pool_guard</a>
            </li>
                
      <li>
  
                          <a href="../plugin.compile_query/index.html" title="plugin.compile_query">
          <span class="none"></span>
        plugin.compile_query</a>
            </li>
                
      <li>
  
                          <a href="../core.postgres_connection/index.html" title="core.postgres_connection">
          <span class="none"></span>
        core.postgres_connection</a>
            </li>
                
      <li>
  
                          <a href="../plugin.postgres_connection_pool/index.html" title="plugin.postgres_connection_pool">
          <span class="none"></span>
        plugin.postgres_connection_pool</a>
            </li>
                
      <li>
  
                          <a href="../core.istorage_connection/index.html" title="core.istorage_connection">
          <span class="none"></span>
        core.istorage_connection</a>
            </li>
                
      <li>
  
                          <a href="../core.recursive_strategy_container/index.html" title="core.recursive_strategy_container">
          <span class="none"></span>
        core.recursive_strategy_container</a>
            </li>
                
      <li>
  
                          <a href="../core.cached_collection/index.html" title="core.cached_collection">
          <span class="none"></span>
        core.cached_collection</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>How to use Scopes</h1>
<div class="section">
<h2><a name="Overview"></a>Overview</h2>
<p>Scope is a key-value storage, where system <a class="externalLink" href="https://en.wikipedia.org/wiki/Service_locator_pattern">service locators</a> like <a href="IOCExample.html">IoC</a> are able to store their internal data.</p>
<div class="section">
<h3><a name="Requirement_for_the_keys"></a>Requirement for the keys</h3>
<p>Because the data is internal, it&#x2019;s better to use a random <a class="externalLink" href="https://en.wikipedia.org/wiki/Globally_unique_identifier">GUID</a> as a key to private data. This key is known only to the users of the data, other users cannot guess the key.</p>

<div class="source">
<div class="source"><pre class="prettyprint">Object scopeKey = ScopeProvider.createScope(null);
IScope scope = ScopeProvider.getScope(scopeKey);
Object key = new Key(java.util.UUID.randomUUID().toString());
Object value = new Object();
scope.setValue(key, value);
// ...
value = scope.getValue(key)
</pre></div></div></div>
<div class="section">
<h3><a name="Why_you_need_scopes"></a>Why you need scopes</h3>
<p>Service locators provide the globally available API, so the scopes give ability to separate the data of service locators in different contexts. For example, you can define totally independent scope for testing environment, so your tests will take the IoC data totally independent on the IoC of the main application.</p>
<p>The service locator should always take it&#x2019;s data from the <i>current scope</i>. But the current scope can be defined and changed externally.</p>
<p>Also scopes can be nested into each other. This allows to <i>override</i> data. If some key is not defined in the current scope, it may be looked in the parent scope. As the opposite you can redefine the value in the current scope, and it doesn&#x2019;t affect the users of the parent scope.</p></div></div>
<div class="section">
<h2><a name="Nested_scopes"></a>Nested scopes</h2>
<p>For example, let define a main scope. It&#x2019;s has no parents, so <tt>null</tt> is passed to <tt>createScope</tt>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">Object mainScopeKey = ScopeProvider.createScope(null);
IScope mainScope = ScopeProvider.getScope(mainScopeKey);
ScopeProvider.setCurrentScope(mainScope);
</pre></div></div>
<p>You can put a value to it. It&#x2019;ll be a main value.</p>

<div class="source">
<div class="source"><pre class="prettyprint">Object mainValue = new Object();
ScopeProvider.getCurrentScope().setValue(key, mainValue);
assertSame(mainValue, ScopeProvider.getCurrentScope().getValue(key));
</pre></div></div>
<p>Now you define a nested scope and make it the current. Pass a main scope as a parent to <tt>createScope</tt>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">Object nestedScopeKey = ScopeProvider.createScope(mainScope);
IScope nestedScope = ScopeProvider.getScope(nestedScopeKey);
ScopeProvider.setCurrentScope(nestedScope);
</pre></div></div>
<p>When you read by the same key, you get the value from the main scope.</p>

<div class="source">
<div class="source"><pre class="prettyprint">assertSame(mainValue, ScopeProvider.getCurrentScope().getValue(key));
</pre></div></div>
<p>You can put a new value to the nested scope. Then you&#x2019;ll read the updated value.</p>

<div class="source">
<div class="source"><pre class="prettyprint">Object nestedValue = new Object();
ScopeProvider.getCurrentScope().setValue(key, nestedValue);
assertSame(nestedValue, ScopeProvider.getCurrentScope().getValue(key));
</pre></div></div>
<p>However, when you return back to the main scope, you&#x2019;ll read the original value.</p>

<div class="source">
<div class="source"><pre class="prettyprint">ScopeProvider.setCurrentScope(mainScope);
assertSame(mainValue, ScopeProvider.getCurrentScope().getValue(key));
</pre></div></div></div>
<div class="section">
<h2><a name="Why_you_need_nested_scopes"></a>Why you need nested scopes</h2>
<p>Imagine you have some system code, which should use a system scope for it&#x2019;s needs. However, you have to call some worker code which is not fully trusted. You want to give the worker all resources you system code have. But you want to isolate worker so it doesn&#x2019;t corrupt system data.</p>
<p>You define two scopes: system and worker. And worker is nested into system.</p>

<div class="source">
<div class="source"><pre class="prettyprint">Object systemScopeKey = ScopeProvider.createScope(null);
systemScope = ScopeProvider.getScope(systemScopeKey);

Object workerScopeKey = ScopeProvider.createScope(systemScope);
workerScope = ScopeProvider.getScope(workerScopeKey);

ScopeProvider.setCurrentScope(systemScope);
</pre></div></div>
<div class="section">
<h3><a name="Call_untrusted_code"></a>Call untrusted code</h3>
<p>You run a system code and have to call some untrusted worker code. You change scope to worker&#x2019;s before call and return it back to system after call.</p>

<div class="source">
<div class="source"><pre class="prettyprint">ScopeProvider.setCurrentScope(workerScope);
workerCall();
ScopeProvider.setCurrentScope(systemScope);
</pre></div></div>
<p>Now you sure the worker cannot damage your system data if the worker cannot change the current scope. The worker must not receive the reference to the system scope, so it cannot switch to it.</p></div>
<div class="section">
<h3><a name="Do_a_system_call"></a>Do a system call</h3>
<p>Otherwise, when a worker code needs to do a system call.</p>

<div class="source">
<div class="source"><pre class="prettyprint">assertSame(workerScope, ScopeProvider.getCurrentScope());
systemCall();
assertSame(workerScope, ScopeProvider.getCurrentScope());
</pre></div></div>
<p>The system call should remember the scope it was called from and temporary switch to the system scope. And before return back to the worker, restore the initial scope.</p>

<div class="source">
<div class="source"><pre class="prettyprint">private void systemCall() throws ScopeProviderException {
    IScope returnScope = ScopeProvider.getCurrentScope();
    ScopeProvider.setCurrentScope(systemScope);
    // do something system
    ScopeProvider.setCurrentScope(returnScope);
}
</pre></div></div>
<p>So the system code can always run in system scope whatever scope it&#x2019;s called from. The system code should keep a reference to the system scope to do this.</p></div></div>
<div class="section">
<h2><a name="Sample_IoC"></a>Sample IoC</h2>
<div class="section">
<h3><a name="IoC_requirements"></a>IoC requirements</h3>
<p>Let&#x2019;s create the simple IoC which takes care about scopes. The IoC will be simple, it just always returns the objects put into it by the key.</p>

<div class="source">
<div class="source"><pre class="prettyprint">IKey key = new Key&lt;MyClass&gt;(&quot;my&quot;);
MyClass main = new MyClass(&quot;main&quot;);
MyIOC.register(key, main);
assertEquals(main, MyIOC.resolve(key));
</pre></div></div>
<p>The IoC must return the parent scope object from the child scope.</p>

<div class="source">
<div class="source"><pre class="prettyprint">ScopeProvider.setCurrentScope(workerScope);
assertEquals(main, MyIOC.resolve(key));
</pre></div></div>
<p>But it should allow to override the object.</p>

<div class="source">
<div class="source"><pre class="prettyprint">MyClass worker = new MyClass(&quot;worker&quot;);
MyIOC.register(key, worker);
assertEquals(worker, MyIOC.resolve(key));
</pre></div></div>
<p>Also it should return to the main scope object when the scope is switched back.</p>

<div class="source">
<div class="source"><pre class="prettyprint">ScopeProvider.setCurrentScope(systemScope);
assertEquals(main, MyIOC.resolve(key));
</pre></div></div></div>
<div class="section">
<h3><a name="IoC_storage"></a>IoC storage</h3>
<p>IoC must have a storage, and keep this storage in the scope.</p>
<p>The storage can be based on a simple <a class="externalLink" href="http://docs.oracle.com/javase/8/docs/api/java/util/Map.html">Map</a>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">private final Map&lt;K, V&gt; storage = new ConcurrentHashMap&lt;&gt;();
</pre></div></div>
<p>So, to save the value, just put it to the map.</p>

<div class="source">
<div class="source"><pre class="prettyprint">public void put(final K key, final V value) {
    storage.put(key, value);
}
</pre></div></div>
<p>However, the storage must do a recursive search: if the key is not found in the current scope, ask the parent scope.</p>

<div class="source">
<div class="source"><pre class="prettyprint">private final MyRecursiveContainer&lt;K, V&gt; parent;

public V get(final K key) {
    V result = null;
    result = storage.get(key);
    if (result == null &amp;&amp; parent != null) {
        result = parent.get(key);
    }
    return result;
}
</pre></div></div>
<p>The parent container is provided in the constructor.</p>

<div class="source">
<div class="source"><pre class="prettyprint">public MyRecursiveContainer(final MyRecursiveContainer&lt;K, V&gt; parent) {
    this.parent = parent;
}
</pre></div></div></div>
<div class="section">
<h3><a name="IoC_responsibility"></a>IoC responsibility</h3>
<p>Our IoC needs a key to save the storage in the scope.</p>

<div class="source">
<div class="source"><pre class="prettyprint">STORAGE_KEY = new Key(java.util.UUID.randomUUID().toString());
</pre></div></div>
<p>And it needs a code which guarantees the storage is correctly created in any new scope appeared in the system. Before adding a new storage to the scope we should ask the new scope for the parent storage to correctly link them.</p>

<div class="source">
<div class="source"><pre class="prettyprint">ScopeProvider.subscribeOnCreationNewScope(
        scope -&gt; {
            try {
                MyRecursiveContainer&lt;IKey, Object&gt; parentStorage = null;
                try {
                    parentStorage = (MyRecursiveContainer&lt;IKey, Object&gt;) scope.getValue(STORAGE_KEY);
                } catch (ScopeException e) {
                    // parent storage does not exists, create a new with null parent
                }
                scope.setValue(STORAGE_KEY, new MyRecursiveContainer&lt;&gt;(parentStorage));
            } catch (Exception e) {
                throw new RuntimeException(e);
            }
        }
);
</pre></div></div>
<p>Then to register an object in IoC we just take the storage from the current scope and put a value into it.</p>

<div class="source">
<div class="source"><pre class="prettyprint">public static void register(final IKey key, final Object value) throws MyIOCException {
    try {
        MyRecursiveContainer&lt;IKey, Object&gt; storage = (MyRecursiveContainer&lt;IKey, Object&gt;)
                ScopeProvider.getCurrentScope().getValue(STORAGE_KEY);
        storage.put(key, value);
    } catch (Throwable e) {
        throw new MyIOCException(e);
    }
}
</pre></div></div>
<p>To resolve the key we take the storage from the current scope again and get the value. The recursive search is done by the storage.</p>

<div class="source">
<div class="source"><pre class="prettyprint">public static &lt;T&gt; T resolve(final IKey&lt;T&gt; key) throws MyIOCException {
    try {
        MyRecursiveContainer&lt;IKey, Object&gt; storage = (MyRecursiveContainer&lt;IKey, Object&gt;)
                ScopeProvider.getCurrentScope().getValue(STORAGE_KEY);
        return (T) storage.get(key);
    } catch (Throwable e) {
        throw new MyIOCException(e);
    }
}
</pre></div></div></div>
<div class="section">
<h3><a name="IoC_objects"></a>IoC objects</h3>
<p>So, the scopes key-value storages with hierarchical structure which allows to search values from child to parent.</p>
<p>But IoC internally is also the key-value storage which holds objects or strategies to resolve objects. And this storage should also be hierarchical with ability to search values from child to parent. The hierarchy of IoC storage follows the hierarchy of scopes.</p>
<p>So, the IoC as a service locator just takes the storage from the current scope and asks it for data. Because you can define different scopes for different situations you can get different (and independent) data from IoC when necessary.</p>
<p><img src="http://www.plantuml.com/plantuml/img/XP2n3i8W48PtdkBIgHruWQRfqib94-FM1V5IgmW4Q1FVNi2ge4sS2Dnt_tq7uquPE5WqX71rqqgYTB1H7JIDVvn7ZY0KPvvgsnJPCUEFFLSQFNh5EvsPcD137wOxZ-AqXlpc-7ms_4jQXKYG1qhRQ5s3mM6q3arPzTAWLMB6iY8a50DKyCc4YRsqGQn89MiOq9LL3SiaGf9YRDRHjaYtpo15CrMI_fAlPSj-dBBjQj1JbDWUByYzv-BqlBwcBV2Qr3ldg_41" alt="IoC in Scopes" /></p></div></div>
<div class="section">
<h2><a name="Code"></a>Code</h2>
<p>The sources of this tutorial:</p>

<ul>
  
<li><a class="externalLink" href="http://smarttools.github.io/smartactors-core/xref/info/smart_tools/smartactors/core/examples/scope/package-frame.html">MyIOC implementation</a></li>
  
<li><a class="externalLink" href="http://smarttools.github.io/smartactors-core/core.examples/xref-test/info/smart_tools/smartactors/core/examples/ScopeExample.html">Tests</a></li>
</ul></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2016.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
